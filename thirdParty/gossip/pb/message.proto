syntax = "proto3";

package pb;

import "github.com/NBSChain/go-nbs/storage/network/pb/nbsMsg.proto";
import "google/protobuf/timestamp.proto";

message BasicHost {
    bool   CanServer    = 1;
    string NatServer    = 2;
    string NatIP        = 3;
    int32  NatPort      = 4;
    string PriIP        = 5;
    string PubIp        = 6;
    string NetworkId    = 7;
}

message Subscribe {
    int64 SeqNo = 1;
    google.protobuf.Timestamp Expire = 2;
    string nodeId = 4;
    BasicHost Addr  = 3;
}

message SynAck {
    int64 SeqNo     = 1;
    string FromId   = 2;
}

message VoteContact {
    int32 TTL           = 1;
    Subscribe Subscribe = 2;
}

message HeartBeat {
    string  FromID  = 1;
}

message ArcReplace {
    string FromId   = 1;
    string ToId     = 2;
    BasicHost Addr  = 3;
}
message ArcDrop {
    string nodeId   = 1;
}

message WeightUpdate {
    string nodeId = 1;
    double weight = 2;
}

message gossip {
    net.pb.MsgType  MsgType     = 1;
    string          MsgId       = 2;
    Subscribe       Subscribe   = 3;
    SynAck          SubAck      = 4;
    VoteContact     VoteContact = 5;
    Subscribe       VoteResult  = 6;
    HeartBeat       HeartBeat   = 7;
    SynAck          SubConfirm  = 8;
    SynAck          VoteAck     = 9;
    ArcReplace      ArcReplace  = 10;
    ArcDrop         ArcDrop     = 11;
    Subscribe       ReplaceAck  = 12;
    WeightUpdate OVWeight = 13;
    WeightUpdate IVWeight = 14;
}